# Лабораторная работа №1.2: "Платы сопряжения ЦАП–АЦП для ПК"
## [КРАТКИЕ ТЕОРЕТИЧЕСКИЕ СВЕДЕНИЯ](theory.html)  
## ПОРЯДОК ВЫПОЛНЕНИЯ РАБОТЫ 
Внимание! При выполнении лабораторных работ подключение к внешним разъемам можно производить только при выключенном питании модуля Е14. Необходимо внимательно следить, чтобы в процессе эксплуатации не было случайного замыкания цепей источника сигнала и общей точки, так как это может вызвать короткое замыкание и выход модуля из строя. 

### Этап 1. Измерение аналоговых сигналов с помощью АЦП 
В работе используется внешний модуль ввода-вывода E14-140 отечественной компании L-CARD. Модуль снабжен 14-битным многоканальным АЦП с мультиплексированием каналов. Максимальная частота преобразования 100 кГц (время преобразования 10 мкс). Связь с компьютером и питание модуля осуществляются по USB-интерфейсу, что позволяет выполнять «горячее» подключение к работающему компьютеру. 
Модуль имеет два разъема для подключения внешних устройств 
(для цифровых сигналов и для аналоговых сигналов). Диапазон внешних сигналов должен быть ограничен значением $\pm$ 10 В. Входное сопротивление АЦП более 10 МОм. Модуль может быть сконфигурирован для получения сигналов как в однофазном (с общей «землей») режиме, так и в дифференциальном режиме. В первом случае доступно 32 входных канала, во втором — 16. 
Для получения, обработки и сохранения данных на ПЭВМ используется специальное программное обеспечение. При этом его можно создавать самостоятельно или брать готовые программные продукты. Возможности пакета PowerGraph позволяют использовать ПЭВМ в качестве вольтметра, самописца, осциллографа. 
После запуска программы PowerGraph необходимо выбрать в предложенном списке устройство, выполнить конфигурирование аналоговых каналов (для каналов 1 и 3 установить однофазный режим, кроме того, необходимо установить диапазон входного сигнала). 

#### Упражнение 1

Измерение постоянного напряжения. На канал 1 со специального источника подается постоянное напряжение милливольтового диапазона — запускается самописец. Сигнал на экране самописца изменяют, вращая рукоятку источника.  

В окне настроек канала можно задать диапазон входного сигнала, выбором диапазона сигнала — изменять разрешение АЦП. Так, предельное разрешение АЦП составляет от 19 мкВ в диапазоне $\pm$0,156 В до 1,22 мВ в диапазоне $\pm$10 В. 
#### Упражнение 2

Измерение переменного сигнала. На канал 3 подается последовательность импульсов с частотой 500 Гц. Изменяя масштаб по оси времени, необходимо добиться четкого отображения сигнала на экране самописца. Открыть спектроанализатор. Проведенный Фурье-анализ позволяет определить частоту сигнала и частоты остальных гармоник.  

В меню «Сервис — Частота регистрации» доступна функция изменения частоты дискретизации АЦП. Задавая частоту дискретизации ниже 1 кГц, можно проиллюстрировать выполнение теоремы Котельникова, согласно которой частота дискретизации должна превышать частоту сигнала в 2 раза. 

#### Самостоятельная работа

Выбрать канал 1. Поворотом ручки регулятора источника напряжения изменить сигнал на экране самописца. В окне настройки канала изменить диапазон входного сигнала, выполнить калибровку сигнала (умножить и сместить).  Выбрать канал 3. Изменением масштаба шкалы времени добиться четкого отображения периодического сигнала на экране самописца. Выбрать директиву «Спектроанализатор» и определить частоту сигнала. 

### Этап 2. Использование среды LabVIEW  при измерении аналоговых сигналов 
Как правило, при создании сложных систем сбора данных и автоматического управления функциональности готовых программных продуктов не хватает. В этом случае необходимо разрабатывать собственные программы. Одним из способов реализации этой задачи является использование среды разработки на языке графического программирования LabVIEW. 
Программы LabVIEW называют виртуальными приборами. При создании и отладке виртуальный прибор состоит из двух окон: лицевой панели, на которой располагаются элементы управления и визуализации, и блок-диаграммы, где реализован программный алгоритм. 
Блок-диаграмма содержит функциональные узлы (источники, приемники сигнала, элементы преобразования данных), которые соединяются между собой проводниками. Проводники обеспечивают передачу данных от одного функционального узла к другому. 

#### Упражнение 3. 

Исследование виртуального прибора. Создать новый виртуальный прибор. Сконфигурировать ввод сигнала. Создать блок вычисления среднего значения. Вывести графики исходного и усредненного сигналов. 

### Этап 3. Применение цифроаналоговых преобразователей  
Цифроаналоговый преобразователь — это устройство для преобразования цифровой информации в аналоговую форму. Принцип работы ЦАП состоит в суммировании аналоговых сигналов, пропорциональных весам разрядов входного цифрового кода, с коэффициентами, равными нулю или единице в зависимости от значения разряда кода. Применяют ЦАП для связи цифровых управляющих систем с устройствами, которые управляются аналоговым сигналом. Значение напряжения, соответствующее единице цифрового кода, называют шагом квантования ΔUкв. На рис. 1.2.1 показана диаграмма изменения выходного напряжения Uвых при подаче на вход ЦАП цифрового кода, изменяющегося последовательно от нуля до N.

<img src="sampling.png" alt="sampling" style="zoom:50%;" />

*Рис. 1.2.1. Диаграмма выходного напряжения ЦАП ( — погрешность дискретизации)*

Рассмотрим основные параметры ЦАП, определяющие точность преобразования и качество его работы.  
1.	Разрядность (число разрядов) — количество разрядов входного кода n, которое характеризует число степеней квантования  N = 2n – 1. 
2.	Абсолютная разрешающая способность da — минимальное значение изменения сигнала на выходе при изменении входного кода на единицу (цена младшего разряда). Ее определяют как  da =Uп.ш /(2n – 1), где Uп.ш — напряжение полной шкалы, соответствующее внешнему опорному напряжению ЦАП. Численно абсолютная разрешающая способность равна шагу квантования ΔUкв. 
3.	Время установления (преобразования) — интервал времени от момента изменения кода на входе ЦАП до момента установления выходного сигнала в заданных пределах. 
4.	Максимальная частота преобразования — наибольшая частота смены кода, при которой заданные параметры соответствуют установленным нормам. 
5.	Абсолютная погрешность преобразования в конечной точке шкалы — отклонение значения выходного напряжения от номинального, соответствующего конечной точке шкалы функции преобразования. Измеряется в единицах младшего разряда преобразования или в процентах. 
6.	Нелинейность преобразования — максимальное отклонение реальной функции преобразования от идеальной (прямая линия).  

Существуют и другие параметры, характеризующие исполнение ЦАП и особенности его функционирования, в их числе входное напряжение, ток потребления, диапазоны выходного напряжения и силы тока. 
Основные принципы работы и влияние параметров ЦАП на качество преобразования рассмотрим на примере двухканального  12-битного ЦАП, размещенного во внешнем модуле ввода-вывода Е14-440. Основные параметры ЦАП этого модуля представлены в приложении 1. Управление работой модуля E14-440 осуществляется с помощью программного пакета PowerGraph. 

#### Упражнение 4

Измерение постоянного напряжения на выходе ЦАП. Рассчитать абсолютную разрешающую способность для данного ЦАП. В окне «Тип сигнала» программы PowerGraph выбрать постоянный сигнал напряжением (в вольтах), равным шагу квантования. Выбрать канал 1. Запустить работу ЦАП, нажав кнопку «Пуск». Проверить показание мультиметра, подключенного к выходу ЦАП. Задать в программе значение уровня выходного сигнала, не кратное шагу квантования, и проверить показание мультиметра. Сделать вывод о дискретном изменении напряжения на выходе ЦАП. 

#### Упражнение 5

Построение диаграммы выходного напряжения ЦАП. Построить диаграмму выходного напряжения, изменяя в программе PowerGraph уровень сигнала (в рамках рабочего диапазона ЦАП 5 В) и выполняя соответствующие измерения напряжения мультиметром. Попробовать оценить абсолютную погрешность преобразования в конечной точке шкалы и нелинейность преобразования. В случае недостаточной точности используемого мультиметра сделать вывод о невозможности такой оценки. 
Самостоятельная работа. В окне «Тип сигнала» программы PowerGraph последовательно указать предлагаемые на выбор тестовые сигналы («синусоида», «ступенька», «треугольник») с различными значениями амплитуды и частоты. С помощью осциллографа проверить изменение напряжения на выходе канала ЦАП. 

### Этап 4. Цифровые входные и выходные линии 
Для обмена информацией между цифровыми устройствами, построенными на электронных логических элементах, используют цифровые входные и выходные линии. Передающиеся по ним цифровые сигналы имеют два стабильных уровня — уровень логического нуля и уровень логической единицы. У микросхем, выполненных по различным технологиям, логические уровни могут различаться. Логические элементы могут работать в режимах положительной и отрицательной логики. Для электронных логических элементов в режиме положительной логики логической единице соответствует высокий уровень напряжения, а логическому нулю — низкий уровень напряжения. В режиме отрицательной логики логической единице соответствует низкий уровень напряжения, а логическому нулю — высокий. 

В идеальном случае все сигналы логических элементов существовали бы в виде двух предельных уровней напряжения (например, 0 и +5 В) и никогда от них не отклонялись. Однако в реальности уровни напряжения цифровых сигналов могут отличаться от идеальных вследствие паразитных падений напряжения и шумов. 

Следует отметить, что диапазон допусков по уровням выходного сигнала обычно ýже, чем входного сигнала. Разность допусков между входным и выходным сигналами называют запасом схемы по помехоустойчивости. 
Наибольшее распространение получили логические элементы на основе биполярных транзисторов — ТТЛ-элементы (транзистор-транзисторная логика) и на основе полевых транзисторов — КМОП-элементы (комплементарные, на основе переходов металл — оксид — полупроводник). 

Принцип работы цифровых входных и выходных линий рассмотрим для модуля ввода-вывода Е14-440. На модуле имеются цифровые ТТЛ-совместимые входные и выходные линии, выполненные на КМОП-элементах при напряжении питания +5 В. Параметры цифровых линий представлены в приложении 1. Управление работой модуля E14-440 осуществляется с помощью программного пакета PowerGraph. 

#### Упражнение 6

Проверка работы цифровых выходов. С помощью интерфейса программы PowerGraph поставить напротив номеров всех каналов галочки, т. е. подать на все цифровые выходы логическую единицу. На разъеме платы должны загореться светодиодные лампочки. С помощью мультиметра измерить уровень напряжения на цифровых выходах. Сделать вывод о вхождении этого значения в диапазон допусков напряжения высокого уровня. Выставить на всех цифровых выходах логический нуль. С помощью мультиметра убедиться в отсутствии напряжения на каналах выходного порта. Представить выходной управляющий сигнал в шестнадцатеричной форме. 

#### Упражнение 7

Проверка работы цифровых входов. С помощью интерфейса программы PowerGraph убедиться, что напротив всех цифровых входов отсутствуют галочки, т. е. модуль  E14-440 воспринимает отсутствие напряжения как логический нуль. Соединить с помощью кабеля один из цифровых входов с выводом +5 В, расположенным на том же разъеме. С помощью интерфейса программы PowerGraph убедиться, что напротив замкнутого на +5 В канала появилась галочка и модуль воспринял напряжение +5 В как логическую единицу. 

## СОДЕРЖАНИЕ ОТЧЕТА 
1.	Основные сходства и различия в модулях сопряжения Е14-140 и Е14-440. Сравнение технических характеристик этих устройств при проведении операций измерения и управления. 
2.	Краткое описание используемых в работе программных сред для управления сбором данных, аналоговым и цифровым каналами.  
3.	Сгенерированные цифровые управляющие сигналы в двоичном и шестнадцатеричном коде. 
4.	Скриншоты интерфейсов используемых программных сред для различных тестовых сигналов («синусоида», «ступенька», «треугольник»).  
5.	Листинг интерфейса созданного в LabVIEW виртуального прибора: лицевой панели и блок-диаграммы. 

## КОНТРОЛЬНЫЕ ВОПРОСЫ 
1.	Каковы принципы сопряжения экспериментальной установки с ЭВМ?  
2.	Сформулируйте перечень и назначение основных элементов схемы сопряжения. 
3.	Какие стандарты на управляющие и измерительные комплексы вы знаете? 
4.	Каковы особенности интерфейсов первого поколения? Приведите примеры.  
5.	Какие типы устройств сопряжения с объектом вы знаете? Приведите их сравнительный анализ. 
6.	Для каких информационно-управляющих систем целесообразно использовать платы сопряжения ЦАП–АЦП? Каковы их разновидности, достоинства и недостатки?  
7.	В каких случаях используют внешние устройства сопряжения ЭВМ с экспериментальным стендом? В чем их достоинства и недостатки?  
8.	Какие вы знаете способы обмена информацией ЭВМ с внешними устройствами? Что такое ТТЛ-стандарт? 
9.	Для чего используется графический процессор в USBустройствах сопряжения? Сравните характеристики систем с графическим процессором и без него.  
10.	Как вы можете сформулировать основные принципы и приемы графического программирования в среде LabVIEW? 

